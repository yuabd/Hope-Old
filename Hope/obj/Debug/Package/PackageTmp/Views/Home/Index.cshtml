@model Hope.Models.Paginated<Hope.Models.Wish>
@{
    ViewBag.Title = "微心愿";
    Layout = "~/Views/Shared/_SiteLayout.cshtml";
}
@section head{
	<link href="/App_Themes/Site/nivo-slider.css" rel="stylesheet" type="text/css" />
}
@section scripts{
	<script src="../../Scripts/jquery.validate.min.js" type="text/javascript"></script>
	<script src="/Scripts/jquery.nivo.slider.pack.js" type="text/javascript"></script>

	<script type="text/javascript">
	    $(function () {
	        $(".rl-guan").click(function () {
	            $("#form").hide();
	        });

	        $('#slider').nivoSlider({
	            effect: 'random',
	            controlNavThumbs: false
	        });

	        $("#apply").validate({
	            rules: {
	                ContactName: { required: true, maxlength: 10 },
	                ContactAddress: { required: true },
	                ContactEmail: { required: true, email: true },
	                ContactTel: { required: true, maxlength: 11 },
	                Message: { maxlength: 300 }
	            },
	            messages: {
	                ContactName: {
	                    required: "<span style='color: red; margin-left: 10px;'>必填</span>",
	                    maxlength: "<span style='color: red; margin-left: 10px;'>名字太长了</span>"
	                },
	                ContactAddress: { required: "<span style='color: red; margin-left: 10px;'>必填</span>" },
	                ContactEmail: {
	                    required: "<span style='color: red; margin-left: 10px;'>必填</span>",
	                    email: "<span style='color: red; margin-left: 10px;'>格式错误</span>"
	                },
	                ContactTel: {
	                    required: "<span style='color: red; margin-left: 10px;'>必填</span>",
	                    maxlength: "<span style='color: red; margin-left: 10px;'>最长为11</span>"
	                },
	                Message: {
	                    maxlength: "<span style='color: red; margin-left: 10px;'>太多了</span>"
	                }
	            }
	        });
	    });

		function apply(wishID, name, detail) {
			$("#_WishID").attr("disabled", "disabled").val(wishID);
			$("#WishID").val(wishID);
			$("#StudentName").attr("disabled", "disabled").val(name);
			$("#Detail").val(detail);
			$("#form").show();
		}
	</script>
}

<div id="form">
<form action="/Home/Apply" method="post" id="apply">
	<div class="rl-guan"><img src="/content/images/rl-guan.gif"></div>
	<div id="form-biao">
		<div id="form-left" class="f_l">
			<h2 style="color: #0088cc;">认领的愿望信息</h2>
			<div class="row">
				<label>愿望编号：</label>
				<input type="text" name="_WishID" id="_WishID"  class="small"/>
				<input type="hidden" name="WishID" id="WishID" />
			</div>
			<div class="row">
				<label> 孩子的姓名：</label>
				<input type="text" id="StudentName" name="StudentName" class="small"/>
			</div>
			<div class="row">
				<label>愿望：</label>
				<textarea id="Detail" cols="" rows="" disabled="disabled" style="width: 170px;height:40px;"></textarea>
			</div>
		</div>
		<div id="form-right" class="f_r">
			<h2 style="color: #c98e5b;">个人信息</h2>
			<div class="row">
				<label>姓名：</label>
				<input type="text" id="ContactName" name="ContactName" class="large"/><cite>*</cite>
			</div>
			<div class="row">
				<label>单位：</label>
				<input type="text" id="ContactAddress" name="ContactAddress" class="large"/><cite>*</cite>
			</div>
			<div class="row">
				<label>联系电话：</label>
				<input type="text" id="ContactTel" name="ContactTel" class="large"/><cite>*</cite>
			</div>
		</div>
		<div class="f_l">
			<div class="row">
				<p>留下您想对小朋友说的话：</p>
			</div>
			<div class="row">
				<textarea name="Message" id="Message" cols="" rows="" style="width:610px;height:86px;"></textarea>
			</div>
			<div class="row">
				<button type="submit" style="background: green; color: White; width: 80px; height: 30px; cursor: pointer; border: 0;">提交</button>
			</div>
		</div>
	</div>
</form>
</div>
<div id="content-head">
	<div id="notice" class="f_l">
		<div>
			<h2>公告：</h2>
			<p style="font-size: 16px; font-family: 微软雅黑; color: Red; margin: 0;">
				认领单位或个人需主动与贫困学生所在学校负责人及本人联系具体认领事宜。活动图文信息请及时报送机关党委。
			</p>
		</div>
		<div>
			<center style="font-size: 18px;color: #ff5c00;">
            <br /><br />
			<p>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;工&nbsp;&nbsp;&nbsp;&nbsp;会<br />
				市局&nbsp;青工委<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;妇工委<br />
			</p>
			</center>
			<center>
				联系电话： 2262575小郭
			</center>
		</div>
	</div>	
	<div id="slider" class="f_l">
		<img src="/Content/images/2013052109391215.jpg" style="width: 735px;" />
		<img src="/content/images/DSCF0215.jpg" />
		<img src="/content/images/DSCF0194.jpg" />
		<img src="/content/images/DSCF0203.jpg" />
		<img src="/content/images/DSCF0208.jpg" />
		<img src="/content/images/zhzx1.jpg" />
		<img src="/content/images/zhzx2.jpg" />
		<img src="/content/images/zhzx3.jpg" />
		<img src="/content/images/zhzx4.jpg" />
		<img src="/content/images/zhzx5.jpg" />
	</div>
    <div id="Apply">
        <a href="/Home/Index?State=0" style="width: 100%; height: 100%; display: block;"></a>
    </div>
	<div class="c_b">
		<h2 style="color: Red; padding: 0 10px; float: right;"><a href="/" style="padding: 10px;">所有愿望</a><a href="/Home/Index?State=0" style="padding: 10px;">待认领</a><a href="/Home/Index?State=1" style="padding: 10px;">已认领</a></h2>
		<MARQUEE style="height: 25px;">
            <span style="color: Red;">最新认领：</span>
			 @foreach (var item in Hope.Helpers.LabelHelper.GetApply().Take(20))
	   {
		   <span style="padding-right: 10px; font-size: 14px; color: #ff5c00;"><b>@(item.ContactName)认领</b>: @(Hope.Helpers.LabelHelper.GetWish(item.WishID).StudentName)的微心愿</span>
	   }
		</MARQUEE>
	</div>
</div>
<div id="table-content">
	<table class="grid">
		<colgroup>
			<col width="3%" />
			<col width="7%" />
			<col width="10%" />
			<col width="5%" />
			<col width="5%" />
			<col width="8%" />
			<col width="10%" />
			<col width="15%" />
			<col width="15%" />
            <col width="12%" />
			<col width="15%" />
		</colgroup>
		<tr>
			<th>编号
            </th>
			<th>姓名</th>
			<th>小小愿望</th>
			<th>负责人</th>
			<th>性别</th>
			<th>年龄</th>
			<th>地址</th>
			<th>本人联系电话</th>
			<th>家庭情况</th>
            <th>愿望年份
            <br />
            <a href="/Home/Index/2014" style="color: Red;">2014年愿望</a><br />
            <a href="/Home/Index/2013">2013年愿望</a><br />
                @*<select id="Year">
                    <option value="2014">2014</option>
                    <option value="2013">2013</option>
                </select>*@
            </th>
			<th>认领状态</th>
		</tr>
		@foreach (var item in Model)
  {
		<tr>
			<td>@item.DateCreated.Year@item.WishID</td>
			<td>@item.StudentName</td>
			<td>@item.Detail</td>
			<td>@item.SchoolName</td>
			<td>@item.Gender</td>
			<td>@item.Age</td>
			<td>@item.Address</td>
			<td>@item.Tel</td>
			<td>@item.Situation</td>
            <td>@item.DateCreated.Year</td>
			<td>
			@if (!item.IsApply)
   {
				<a href="javascript:void(0);" onclick="apply('@item.WishID', '@item.StudentName', '@item.Detail');" class="button new-button">认领该愿望</a>
   }
   else
   {
			<span style="width: 80px; height: 30px; ">@(item.Apply.ContactName)认领</span>
   }
			</td>
		</tr>
  }
	</table>
	@Model.Pager("pager")
</div>
